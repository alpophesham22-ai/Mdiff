<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ğŸ“‹ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</title>
<style>
body { font-family: sans-serif; margin:20px; }
button { width:100%; padding:10px; margin:5px 0; font-size:16px; }
.client { border:1px solid #ccc; padding:10px; margin:10px 0; border-radius:6px; }
.client-buttons { display:flex; gap:6px; margin-top:6px; }
.client-buttons button { flex:1; padding:6px; font-size:14px; }
</style>
</head>
<body>

<h1>ğŸ“‹ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h1>
<button onclick="location.href='add.html'">â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„</button>
<button onclick="location.href='import.html'">â¬†ï¸ Ø§Ø³ØªÙŠØ±Ø§Ø¯ / â¬‡ï¸ ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª</button>
<button onclick="location.href='search.html'">ğŸ” Ø¨Ø­Ø« ÙˆØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</button>

<h2>ğŸ‘¥ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¬Ù„ÙˆÙ†</h2>
<div id="clients">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>

<script>
const DB_NAME = 'ClientsDB', STORE_NAME='clients';

function openDB() {
  return new Promise((resolve,reject)=>{
    const r = indexedDB.open(DB_NAME,1);
    r.onupgradeneeded = e => { e.target.result.createObjectStore(STORE_NAME,{keyPath:'id'}); };
    r.onsuccess = e => resolve(e.target.result);
    r.onerror = e => reject(e.target.error);
  });
}

function getAllClients() {
  return openDB().then(db => new Promise((res,rej)=>{
    const tx = db.transaction(STORE_NAME,'readonly');
    const store = tx.objectStore(STORE_NAME);
    const req = store.getAll();
    req.onsuccess = ()=>res(req.result);
    req.onerror = ()=>rej(req.error);
  }));
}

function loadClients() {
  getAllClients().then(clients=>{
    const container = document.getElementById('clients');
    container.innerHTML = '';
    if(clients.length===0){ container.textContent='Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ø³Ø¬Ù„ÙˆÙ†.'; return; }

    clients.forEach(c=>{
      const div = document.createElement('div');
      div.className = 'client';
      div.innerHTML = `
        <strong>${c.name}</strong><br>
        â˜ï¸ ${c.phone}<br>
        ğŸ†” ${c.id}<br>
        ğŸ¥— Ø§Ø´ØªØ±Ø§Ùƒ: ${c.subName || "-"}<br>
        ğŸ“… Ù…Ù† ${c.startDate} Ø¥Ù„Ù‰ ${c.endDate}
      `;
      const btns = document.createElement('div');
      btns.className='client-buttons';

      const editBtn = document.createElement('button');
      editBtn.textContent='âœï¸ ØªØ¹Ø¯ÙŠÙ„';
      editBtn.onclick = ()=> location.href=`search.html?id=${c.id}`;

      btns.appendChild(editBtn);
      div.appendChild(btns);
      container.appendChild(div);
    });
  });
}

loadClients();
</script>
</body>
</html>
